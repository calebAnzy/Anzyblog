<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blog Content</title>
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/css/all.min.css">
    <link rel="stylesheet" href="assets/css/style.css">
    <style>
        body {
            overflow-x: hidden;
        }
    </style>
</head>

<body class="container py-4">

  <div id="singlePost"></div>

  <script type="module">
    import { supabase } from './supabase.js';

    // Get the post ID from the URL (example: blog.html?id=123)
    const urlParams = new URLSearchParams(window.location.search);
    const postId = urlParams.get('id');

    async function loadSinglePost() {
      if (!postId) {
        document.getElementById('singlePost').innerHTML = '<p>No post ID found.</p>';
        return;
      }

      // Fetch the post from Supabase
      const { data: post, error } = await supabase
        .from('posts')
        .select('*')
        .eq('id', postId)
        .single();

      if (error) {
        console.error('Error fetching post:', error.message);
        document.getElementById('singlePost').innerHTML = '<p>Error loading post.</p>';
        return;
      }

      // Render the post
      const postDate = new Date(post.created_at).toLocaleDateString();

      const postHTML = `
        <div class="card mb-3">
          <img src="${post.image_url || 'assets/img/placeholder.jpg'}" class="card-img-top" alt="${post.title}">
          <div class="card-body">
            <h6>${postDate}</h6>
            <h2>${post.title}</h2>
            <p>${post.content}</p>
            <hr>
            <p><strong>Author:</strong> ${post.author || 'Admin'}</p>
          </div>
        </div>
      `;

      document.getElementById('singlePost').innerHTML = postHTML;
    }

    loadSinglePost();
  </script>
</body>

</html>